<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalle Proceso: Gerencia de Proyectos - Condugas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        /* Estilos CSS (idénticos a las páginas de proceso anteriores) */
        #objectiveNetwork { width: 100%; height: 85vh; border: 1px solid #e2e8f0; border-radius: 0.5rem; background-color: #f8fafc; position: relative; overflow: hidden; }
        canvas { display: block; width: 100%; height: 100%; }
        .vis-tooltip { position: absolute; visibility: hidden; padding: 8px; white-space: nowrap; font-family: Inter, sans-serif; font-size: 13px; color: #1f2937; background-color: rgba(255, 255, 255, 0.95); border: 1px solid #d1d5db; border-radius: 0.375rem; z-index: 1000; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); pointer-events: none; }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .vis-navigation .vis-button { background-color: #292d63; color: white; border: none; border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.2); transition: background-color 0.3s ease; }
        .vis-navigation .vis-button:hover { background-color: #1d70b7; }
        #detailPanel { position: absolute; top: 1rem; right: -450px; width: 400px; max-width: 90%; height: calc(100% - 2rem); background-color: white; border-radius: 0.5rem; box-shadow: -5px 0px 15px rgba(0, 0, 0, 0.1); transition: right 0.4s ease-in-out; z-index: 20; overflow-y: auto; display: flex; flex-direction: column; }
        #detailPanel.show { right: 1rem; }
        #detailPanelContent { padding: 1.5rem; flex-grow: 1; }
        #detailPanelHeader { padding: 1rem 1.5rem; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; }
        #closeDetailPanel { background: none; border: none; font-size: 1.5rem; line-height: 1; cursor: pointer; color: #6b7280; }
        #closeDetailPanel:hover { color: #1f2937; }
        #detailSubObjectives ul { list-style-type: decimal; list-style-position: inside; margin-left: 0.5rem; }
        #detailSubObjectives li { margin-bottom: 0.5rem; padding-left: 0.5rem; }
        #detailDataStatus { margin-top: auto; padding-top: 1rem; border-top: 1px dashed #e2e8f0; font-size: 0.75rem; color: #6b7280; font-style: italic; }
        .nav-links a { margin: 0 0.5rem; padding: 0.5rem 1rem; border-radius: 0.375rem; transition: background-color 0.3s ease; font-weight: 500; text-decoration:none; }
        .nav-links a.active { background-color: #292d63; color: white; }
        .nav-links a:not(.active) { background-color: #e0e7ff; color: #3730a3; }
        .nav-links a:not(.active):hover { background-color: #c7d2fe; }
    </style>
</head>
<body class="bg-gray-100 p-4 md:p-8">

    <header class="text-center mb-6">
        <h1 class="text-3xl md:text-4xl font-bold text-[#292d63]">Matriz de Decisiones y Responsabilidades Condugas</h1>
    </header>

    <nav class="nav-links flex flex-wrap justify-center mb-8 text-sm md:text-base">
        <a href="dashboard_principal.html">Dashboard Principal</a>
        <a href="objetivos_interactivos_detalle.html">Visualización de Objetivos</a>
        <a href="vision_general_procesos.html">Visión General de Procesos</a> 
        <a href="decisiones_estrategicas.html">Decisiones Estratégicas</a>
        <a href="decisiones_tacticas.html">Decisiones Tácticas</a>
        <a href="decisiones_operativas.html">Decisiones Operativas</a>
        <a href="decisiones_supervivencia.html">Decisiones de Supervivencia</a>
        <a href="flujo_decisiones.html">Flujo entre Niveles</a>
    </nav>

    <div class="text-center mb-8">
        <h2 class="text-2xl font-semibold text-gray-700">Detalle de Proceso: Gerencia de Proyectos</h2>
        <p class="text-md text-gray-500 mt-1">Objetivos y Conexiones Directas</p>
        <a href="vision_general_procesos.html" class="text-[#1d70b7] hover:text-[#292d63] hover:underline mt-2 inline-block">&larr; Volver a Visión General de Procesos</a>
    </div>

    <div class="mb-6 p-4 bg-[#e0f2fe] border border-[#7dd3fc] text-[#075985] rounded-lg text-sm shadow">
         <p class="font-bold mb-2">Leyenda y Uso:</p>
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2">
            <div><p><span class="inline-block w-4 h-4 rounded-md bg-[#292d63] mr-2 align-middle"></span> <strong class="text-[#292d63]">Área/Proceso</strong></p></div>
            <div>
                <p><span class="inline-block w-4 h-4 rounded-full bg-[#f8b133] mr-2 align-middle"></span> <strong class="text-[#f8b133]">Obj. Estratégico</strong></p>
                <p><span class="inline-block w-4 h-4 rounded-full bg-[#1d70b7] mr-2 align-middle"></span> <strong class="text-[#1d70b7]">Obj. Táctico</strong></p>
            </div>
             <div><p><span class="inline-block w-4 h-4 rounded-full bg-[#ffda05] mr-2 align-middle"></span> <strong class="text-[#ca8a04]">Obj. Operativo</strong></p></div>
        </div>
        <p class="mt-3"><strong>Interactividad:</strong> Mueva/zoom el diagrama. <strong class="text-red-600">Clic en círculo (Objetivo):</strong> Muestra detalles (declaración/sub-objetivos).</p>
        <p class="text-xs italic mt-1">Nota: La declaración y sub-objetivos detallados solo están presentes para los nodos de ejemplo (FIN-01, LOG-01, GP-01, NN-01). Los demás muestran texto genérico.</p>
    </div>

    <main class="relative">
        <div id="objectiveNetwork">
            <div id="detailPanel">
                 <div id="detailPanelHeader">
                    <h3 id="detailTitle" class="text-xl font-bold text-[#292d63]">Detalles del Objetivo</h3>
                    <button id="closeDetailPanel" title="Cerrar">&times;</button>
                </div>
                <div id="detailPanelContent" class="text-gray-700 text-sm">
                    <div class="mb-4"> <strong class="text-gray-900">Declaración:</strong> <p id="detailDeclaration" class="mt-1"></p> </div>
                    <div class="mb-4"> <strong class="text-gray-900">Sub-Objetivos:</strong> <div id="detailSubObjectives" class="mt-1"></div> </div>
                    <div class="mb-4"> <strong class="text-gray-900">Áreas/Procesos Conectados:</strong> <p id="detailConnections" class="mt-1"></p> </div>
                    <div id="detailDataStatus">Nota: Datos completos solo disponibles para nodos de ejemplo.</div>
                </div>
            </div>
        </div>
        <div id="tooltip" class="vis-tooltip"></div>
    </main>

    <footer class="text-center mt-8 text-sm text-gray-500">
        Proceso Gerencia de Proyectos - Plan Estratégico 2025
    </footer>

    <script type="text/javascript">
        const currentProcessId = 'GP'; // Define the current process for this page: GERENCIA DE PROYECTOS

        // --- Data Preparation (Include ALL objectivesData and processAreas) ---
        // COPIAR Y PEGAR EL BLOQUE COMPLETO DE 'objectivesData' y 'processAreas'
        // del artefacto "objetivos_interactivos_con_nav" o "proceso_estrategia_detalle"
        // para asegurar que todos los datos estén disponibles aquí.
        const objectivesData = [
            // Financiero
            { id: 'FIN-01', label: 'FIN-01', title: 'FIN-01 (Táctico)', category: 'Tactical', declaration: "Asegurar una ejecución presupuestal del 95% o más por proyecto...", subObjectives: ["Implementar revisiones presupuestales...", "Desarrollar alertas tempranas...", "Capacitar trimestralmente..."], connections: ['GP', 'CNT', 'LOG'], isExample: true },
            { id: 'FIN-02', label: 'FIN-02', title: 'FIN-02 (Operativo)', category: 'Operational', declaration: "Reducir el ciclo de cuentas por cobrar a menos de 60 días...", subObjectives: ["Implementar sistema de facturación electrónica...", "Establecer política de descuentos...", "Asignar gestor de cobro específico..."], connections: ['COM', 'GP', 'CNT', 'LGL'], isExample: false },
            { id: 'FIN-04', label: 'FIN-04', title: 'FIN-04 (Táctico)', category: 'Tactical', declaration: "Optimizar el flujo de caja operativo mensual en al menos un 10%...", subObjectives: ["Implementar modelo de proyección...", "Negociar plazos de pago...", "Optimizar gestión de inventarios..."], connections: ['CNT', 'COM', 'LOG', 'GP'], isExample: false },
            { id: 'FIN-05', label: 'FIN-05', title: 'FIN-05 (Táctico)', category: 'Tactical', declaration: "Garantizar una rentabilidad neta por proyecto mínima del 7%...", subObjectives: ["Implementar sistema de costeo...", "Realizar análisis de rentabilidad...", "Establecer comité de revisión..."], connections: ['GP', 'CNT', 'COM', 'NN'], isExample: false },
            { id: 'FIN-06', label: 'FIN-06', title: 'FIN-06 (Estratégico)', category: 'Strategic', declaration: "Implementar modelo de gestión de riesgos financieros...", subObjectives: ["Desarrollar matriz de riesgos...", "Establecer políticas de cobertura...", "Realizar análisis de sensibilidad..."], connections: ['NN', 'LGL', 'EST', 'GP'], isExample: false },
            { id: 'FIN-09', label: 'FIN-09', title: 'FIN-09 (Táctico)', category: 'Tactical', declaration: "Establecer proceso formal de evaluación financiera...", subObjectives: ["Definir metodología estándar...", "Establecer comité de inversiones...", "Realizar seguimiento post-inversión..."], connections: ['EST', 'GP', 'NN', 'AREAS_SOLIC'], isExample: false },
            { id: 'FIN-11', label: 'FIN-11', title: 'FIN-11 (Estratégico)', category: 'Strategic', declaration: "Asegurar que propuestas cumplan criterios de rentabilidad...", subObjectives: ["Integrar equipo financiero...", "Establecer check-list financiero...", "Realizar análisis de sensibilidad..."], connections: ['NN', 'GP', 'LGL'], isExample: false },
            // Logistico
            { id: 'LOG-01', label: 'LOG-01', title: 'LOG-01 (Táctico)', category: 'Tactical', declaration: "Reducir el costo logístico total por proyecto en un 8%...", subObjectives: ["Implementar software optimización rutas...", "Consolidar cargas y renegociar tarifas...", "Realizar análisis trimestral costos..."], connections: ['GP', 'LOG', 'FIN', 'CNT'], isExample: true },
            { id: 'LOG-02', label: 'LOG-02', title: 'LOG-02 (Operativo)', category: 'Operational', declaration: "Aumentar la disponibilidad operativa de equipos críticos al 90%...", subObjectives: ["Implementar programa mantenimiento preventivo...", "Asegurar stock mínimo repuestos...", "Reducir tiempo medio reparación..."], connections: ['GP', 'MANT', 'LOG'], isExample: false },
            { id: 'LOG-03', label: 'LOG-03', title: 'LOG-03 (Operativo)', category: 'Operational', declaration: "Lograr que el 95% de las entregas de materiales y equipos sean a tiempo...", subObjectives: ["Establecer SLAs claros...", "Implementar sistema seguimiento...", "Mejorar planificación demanda..."], connections: ['GP', 'LOG', 'PROV'], isExample: false },
            { id: 'LOG-04', label: 'LOG-04', title: 'LOG-04 (Operativo)', category: 'Operational', declaration: "Controlar el tiempo de inactividad de equipos críticos por causas logísticas...", subObjectives: ["Optimizar proceso solicitud repuestos...", "Establecer acuerdos transporte express...", "Analizar mensualmente causas..."], connections: ['MANT', 'LOG', 'GP'], isExample: false },
            { id: 'LOG-05', label: 'LOG-05', title: 'LOG-05 (Táctico)', category: 'Tactical', declaration: "Implementar una estrategia de abastecimiento eficiente para reducir costos...", subObjectives: ["Consolidar volumen compras...", "Realizar licitaciones anuales...", "Desarrollar programa evaluación proveedores..."], connections: ['LOG', 'GP', 'FIN', 'LGL'], isExample: false },
            { id: 'LOG-06', label: 'LOG-06', title: 'LOG-06 (Táctico)', category: 'Tactical', declaration: "Desarrollar e implementar sistema gestión desempeño proveedores logísticos...", subObjectives: ["Definir KPIs evaluación...", "Establecer reuniones revisión...", "Implementar planes mejora..."], connections: ['LOG', 'GP'], isExample: false },
            { id: 'LOG-07', label: 'LOG-07', title: 'LOG-07 (Táctico)', category: 'Tactical', declaration: "Optimizar los niveles de inventario de materiales y repuestos...", subObjectives: ["Implementar clasificación ABC...", "Mejorar precisión previsiones demanda...", "Establecer proceso disposición inventario..."], connections: ['FIN', 'GP', 'LOG', 'CNT'], isExample: false },
            { id: 'LOG-08', label: 'LOG-08', title: 'LOG-08 (Estratégico)', category: 'Strategic', declaration: "Implementar programa piloto para medir y reducir huella de carbono...", subObjectives: ["Establecer metodología cálculo...", "Evaluar viabilidad uso vehículos...", "Optimizar rutas y consolidación..."], connections: ['LOG', 'GP', 'EST'], isExample: false },
            { id: 'LOG-09', label: 'LOG-09', title: 'LOG-09 (Táctico)', category: 'Tactical', declaration: "Implementar tecnología de seguimiento y localización (GPS/RFID)...", subObjectives: ["Seleccionar plataforma tecnológica...", "Instalar dispositivos equipos...", "Integrar información seguimiento..."], connections: ['TI', 'GP', 'MANT', 'SEGURIDAD'], isExample: false },
            { id: 'LOG-10', label: 'LOG-10', title: 'LOG-10 (Táctico)', category: 'Tactical', declaration: "Reducir los costos de almacenamiento en un 7%...", subObjectives: ["Realizar análisis utilización espacio...", "Rediseñar layout bodegas...", "Evaluar consolidación bodegas..."], connections: ['LOG', 'GP'], isExample: false },
            { id: 'LOG-11', label: 'LOG-11', title: 'LOG-11 (Operativo)', category: 'Operational', declaration: "Asegurar cumplimiento 100% normativa transporte carga...", subObjectives: ["Realizar auditoría interna cumplimiento...", "Capacitar anualmente personal...", "Mantener actualizada documentación..."], connections: ['LGL', 'GH', 'GP'], isExample: false },
            { id: 'LOG-12', label: 'LOG-12', title: 'LOG-12 (Estratégico)', category: 'Strategic', declaration: "Implementar proceso formal planificación demanda logística (S&OP)...", subObjectives: ["Establecer reuniones mensuales S&OP...", "Desarrollar modelo previsión demanda...", "Alinear planes abastecimiento..."], connections: ['GP', 'NN', 'LOG', 'FIN'], isExample: false },
            { id: 'LOG-13', label: 'LOG-13', title: 'LOG-13 (Operativo)', category: 'Operational', declaration: "Digitalizar 90% documentación logística...", subObjectives: ["Implementar sistema gestión documental...", "Establecer uso dispositivos móviles...", "Integrar documentación digital..."], connections: ['ADM', 'CNT', 'TI', 'GP'], isExample: false },
            { id: 'LOG-14', label: 'LOG-14', title: 'LOG-14 (Táctico)', category: 'Tactical', declaration: "Desarrollar plan contingencia logística para interrupciones mayores...", subObjectives: ["Identificar riesgos logísticos críticos...", "Definir rutas y proveedores alternativos...", "Establecer protocolos comunicación..."], connections: ['GP', 'LOG', 'SEGURIDAD', 'EST'], isExample: false },
            { id: 'LOG-15', label: 'LOG-15', title: 'LOG-15 (Operativo)', category: 'Operational', declaration: "Reducir en un 15% los errores en despachos...", subObjectives: ["Implementar sistema verificación código barras...", "Mejorar capacitación personal bodega...", "Realizar auditorías aleatorias despachos..."], connections: ['GP', 'CNT', 'GH'], isExample: false },
            // Administrativo
            { id: 'ADM-06', label: 'ADM-06', title: 'ADM-06 (Estratégico)', category: 'Strategic', declaration: "Implementar módulos clave faltantes del sistema ERP...", subObjectives: ["Definir alcance y priorizar módulos...", "Ejecutar proyecto implementación...", "Asegurar integración datos..."], connections: ['TI', 'FIN', 'CNT', 'LOG', 'GP', 'GH'], isExample: false },
            { id: 'ADM-15', label: 'ADM-15', title: 'ADM-15 (Táctico)', category: 'Tactical', declaration: "Asegurar que pólizas de seguro estén vigentes...", subObjectives: ["Mantener inventario pólizas...", "Realizar análisis anual riesgos...", "Gestionar proceso renovación..."], connections: ['LGL', 'FIN', 'GP', 'LOG'], isExample: false },
            // Gestion Humana
            { id: 'GH-04', label: 'GH-04', title: 'GH-04 (Táctico)', category: 'Tactical', declaration: "Capacitar al 100% del personal operativo en competencias clave...", subObjectives: ["Actualizar matriz competencias...", "Diseñar programas capacitación...", "Ejecutar y registrar capacitaciones..."], connections: ['GP', 'OPER', 'SST'], isExample: false },
            { id: 'GH-05', label: 'GH-05', title: 'GH-05 (Estratégico)', category: 'Strategic', declaration: "Garantizar cero (0) accidentes graves o fatales...", subObjectives: ["Reforzar programa seguridad...", "Realizar auditorías seguridad...", "Investigar incidentes..."], connections: ['SST', 'GP', 'OPER', 'TODAS'], isExample: false },
            // Legal
            { id: 'LGL-01', label: 'LGL-01', title: 'LGL-01 (Estratégico)', category: 'Strategic', declaration: "Mantener 100% cumplimiento requisitos legales y contractuales...", subObjectives: ["Implementar check-list verificación...", "Realizar revisión legal obligatoria...", "Mantener base datos requisitos..."], connections: ['NN', 'COM', 'GP', 'LOG'], isExample: false },
            { id: 'LGL-02', label: 'LGL-02', title: 'LGL-02 (Táctico)', category: 'Tactical', declaration: "Reducir los procesos legales activos (litigios y arbitrajes) en un 20%...", subObjectives: ["Analizar inventario procesos...", "Implementar estrategia negociación...", "Fortalecer mecanismos prevención..."], connections: ['FIN', 'GP', 'COM', 'GH'], isExample: false },
            { id: 'LGL-06', label: 'LGL-06', title: 'LGL-06 (Táctico)', category: 'Tactical', declaration: "Desarrollar y aprobar plantillas de contratos estandarizadas...", subObjectives: ["Identificar tipos contratos recurrentes...", "Redactar plantillas estándar...", "Obtener aprobación interna..."], connections: ['COM', 'LOG', 'GP', 'NN'], isExample: false },
            // Gerencia de Proyectos
            { id: 'GP-01', label: 'GP-01', title: 'GP-01 (Táctico)', category: 'Tactical', declaration: "Cumplir al menos el 95% del cronograma de ejecución...", subObjectives: ["Implementar metodología ruta crítica...", "Realizar seguimiento semanal...", "Establecer planes acción inmediatos..."], connections: ['LOG', 'GH', 'FIN', 'CLIENTE'], isExample: true },
            { id: 'GP-02', label: 'GP-02', title: 'GP-02 (Táctico)', category: 'Tactical', declaration: "Reducir las desviaciones presupuestales negativas a menos del 5%...", subObjectives: ["Implementar sistema Valor Ganado...", "Realizar proyecciones costo...", "Aprobar formalmente órdenes cambio..."], connections: ['FIN', 'CNT', 'LOG', 'GP'], isExample: false },
            { id: 'GP-03', label: 'GP-03', title: 'GP-03 (Táctico)', category: 'Tactical', declaration: "Aumentar la productividad operativa promedio en frentes de trabajo clave...", subObjectives: ["Medir líneas base productividad...", "Implementar mejoras métodos...", "Medir y comparar productividad..."], connections: ['OPER', 'GH', 'LOG', 'MANT'], isExample: false },
            { id: 'GP-04', label: 'GP-04', title: 'GP-04 (Operativo)', category: 'Operational', declaration: "Reducir el número de no conformidades técnicas identificadas...", subObjectives: ["Reforzar puntos inspección...", "Capacitar personal operativo...", "Analizar causas raíz..."], connections: ['CALIDAD', 'OPER', 'GH', 'LOG'], isExample: false },
            { id: 'GP-05', label: 'GP-05', title: 'GP-05 (Táctico)', category: 'Tactical', declaration: "Lograr una calificación de satisfacción del cliente del 90% o superior...", subObjectives: ["Implementar encuesta estandarizada...", "Realizar reunión cierre formal...", "Tomar acciones basadas feedback..."], connections: ['COM', 'DIR'], isExample: false },
            { id: 'GP-06', label: 'GP-06', title: 'GP-06 (Estratégico)', category: 'Strategic', declaration: "Implementar un software avanzado de gestión de proyectos (PPM)...", subObjectives: ["Seleccionar e implementar plataforma...", "Migrar información proyectos...", "Capacitar en uso software..."], connections: ['TI', 'FIN', 'EST'], isExample: false },
            { id: 'GP-07', label: 'GP-07', title: 'GP-07 (Estratégico)', category: 'Strategic', declaration: "Estandarizar e implementar una metodología de gestión de riesgos por proyecto...", subObjectives: ["Desarrollar metodología estándar...", "Integrar gestión riesgos...", "Realizar revisiones periódicas..."], connections: ['FIN', 'LGL', 'LOG', 'GH', 'SST'], isExample: false },
            { id: 'GP-08', label: 'GP-08', title: 'GP-08 (Táctico)', category: 'Tactical', declaration: "Desarrollar e implementar protocolos de comunicación estandarizados...", subObjectives: ["Definir matriz comunicación...", "Establecer plantillas reportes...", "Capacitar equipos proyecto..."], connections: ['COM', 'CLIENTE', 'TODAS'], isExample: false },
            { id: 'GP-09', label: 'GP-09', title: 'GP-09 (Táctico)', category: 'Tactical', declaration: "Mejorar la planificación y asignación de recursos compartidos...", subObjectives: ["Implementar herramienta o proceso...", "Realizar planificación capacidad...", "Establecer criterios priorización..."], connections: ['GH', 'LOG', 'MANT', 'FIN'], isExample: false },
            { id: 'GP-10', label: 'GP-10', title: 'GP-10 (Estratégico)', category: 'Strategic', declaration: "Establecer un proceso formal de lecciones aprendidas...", subObjectives: ["Definir plantilla y proceso...", "Crear repositorio centralizado...", "Incorporar revisión lecciones..."], connections: ['CALIDAD', 'EST', 'AREAS_INV'], isExample: false },
            { id: 'GP-11', label: 'GP-11', title: 'GP-11 (Estratégico)', category: 'Strategic', declaration: "Asegurar que 100% Gerentes Proyecto estén certificados o completen programa...", subObjectives: ["Definir estándar certificación...", "Evaluar nivel actual...", "Facilitar recursos y tiempo..."], connections: ['GH'], isExample: false },
            { id: 'GP-12', label: 'GP-12', title: 'GP-12 (Táctico)', category: 'Tactical', declaration: "Implementar un sistema de gestión de cambios robusto...", subObjectives: ["Definir proceso formal solicitud...", "Establecer Comité Control Cambios...", "Comunicar claramente proceso..."], connections: ['CLIENTE', 'COM', 'FIN', 'LGL'], isExample: false },
            { id: 'GP-13', label: 'GP-13', title: 'GP-13 (Táctico)', category: 'Tactical', declaration: "Reducir el tiempo del ciclo desde finalización técnica hasta facturación final...", subObjectives: ["Mapear y optimizar proceso cierre...", "Asegurar entrega oportuna documentación...", "Mejorar coordinación entre áreas..."], connections: ['FIN', 'CNT', 'COM', 'ADM', 'LGL'], isExample: false },
            { id: 'GP-14', label: 'GP-14', title: 'GP-14 (Táctico)', category: 'Tactical', declaration: "Garantizar que todos los proyectos cumplan 100% requisitos ambientales y sociales...", subObjectives: ["Identificar requisitos A&S...", "Desarrollar e implementar Plan Manejo...", "Realizar seguimiento y auditorías..."], connections: ['LGL', 'SST', 'REL_COM'], isExample: false },
            { id: 'GP-15', label: 'GP-15', title: 'GP-15 (Estratégico)', category: 'Strategic', declaration: "Implementar metodología BIM o equivalentes digitales...", subObjectives: ["Seleccionar proyectos piloto...", "Definir alcance uso BIM...", "Evaluar resultados..."], connections: ['ING', 'TI', 'NN'], isExample: false },
            // Nuevos Negocios
            { id: 'NN-01', label: 'NN-01', title: 'NN-01 (Estratégico)', category: 'Strategic', declaration: "Captar nuevos contratos firmados por valor mínimo...", subObjectives: ["Desarrollar pipeline oportunidades...", "Priorizar esfuerzos comerciales...", "Realizar seguimiento semanal pipeline..."], connections: ['COM', 'FIN', 'LGL', 'GP', 'EST'], isExample: true },
            { id: 'NN-02', label: 'NN-02', title: 'NN-02 (Estratégico)', category: 'Strategic', declaration: "Participar activamente en mínimo 20 procesos licitatorios alto impacto...", subObjectives: ["Identificar y monitorear fuentes...", "Establecer criterios alto impacto...", "Preparar y presentar propuestas..."], connections: ['LGL', 'FIN', 'GP', 'ING'], isExample: false },
            { id: 'NN-03', label: 'NN-03', title: 'NN-03 (Táctico)', category: 'Tactical', declaration: "Lograr tasa conversión propuestas presentadas a contratos adjudicados 25%...", subObjectives: ["Implementar proceso calificación Go/No-Go...", "Realizar análisis post-mortem...", "Fortalecer personalización propuestas..."], connections: ['COM', 'FIN', 'LGL', 'GP'], isExample: false },
            { id: 'NN-05', label: 'NN-05', title: 'NN-05 (Estratégico)', category: 'Strategic', declaration: "Desarrollar propuestas con clara diferenciación técnica o valor agregado...", subObjectives: ["Fomentar colaboración temprana...", "Incorporar propuesta valor diferenciada...", "Investigar soluciones innovadoras..."], connections: ['GP', 'ING', 'EST'], isExample: false },
            { id: 'NN-07', label: 'NN-07', title: 'NN-07 (Estratégico)', category: 'Strategic', declaration: "Realizar análisis de competidores clave...", subObjectives: ["Identificar principales competidores...", "Recopilar y analizar información...", "Elaborar informe semestral..."], connections: ['EST', 'COM', 'GP'], isExample: false },
            { id: 'NN-08', label: 'NN-08', title: 'NN-08 (Estratégico)', category: 'Strategic', declaration: "Establecer al menos 2 nuevas alianzas estratégicas...", subObjectives: ["Identificar áreas donde alianzas...", "Prospectar y evaluar socios...", "Formalizar acuerdos colaboración..."], connections: ['LGL', 'EST', 'GP'], isExample: false },
            { id: 'NN-11', label: 'NN-11', title: 'NN-11 (Táctico)', category: 'Tactical', declaration: "Asegurar que todas las propuestas presentadas cumplan márgenes rentabilidad...", subObjectives: ["Incluir análisis financiero detallado...", "Utilizar herramientas estandarizadas...", "Escalar decisiones precios..."], connections: ['FIN', 'GP', 'CNT'], isExample: false },
            { id: 'NN-14', label: 'NN-14', title: 'NN-14 (Táctico)', category: 'Tactical', declaration: "Implementar proceso formal retroalimentación post-licitación...", subObjectives: ["Solicitar sistemáticamente reuniones...", "Preparar cuestionario estructurado...", "Sistematizar y analizar información..."], connections: ['LGL', 'GP'], isExample: false },
            { id: 'NN-15', label: 'NN-15', title: 'NN-15 (Estratégico)', category: 'Strategic', declaration: "Explorar oportunidades negocio servicios valor agregado...", subObjectives: ["Investigar tendencias tecnológicas...", "Identificar oportunidades sinergia...", "Desarrollar caso negocio preliminar..."], connections: ['EST', 'GP', 'ING'], isExample: false },
            // Contabilidad
            { id: 'CNT-09', label: 'CNT-09', title: 'CNT-09 (Estratégico)', category: 'Strategic', declaration: "Optimizar plan cuentas contables para reflejar mejor líneas negocio...", subObjectives: ["Analizar estructura actual...", "Rediseñar segmentos plan cuentas...", "Implementar cambios sistema ERP..."], connections: ['FIN', 'TI', 'GP', 'COM'], isExample: false },
            { id: 'CNT-15', label: 'CNT-15', title: 'CNT-15 (Táctico)', category: 'Tactical', declaration: "Establecer proceso claro cálculo provisiones complejas...", subObjectives: ["Documentar metodología cálculo...", "Establecer roles y responsabilidades...", "Asegurar revisión periódica..."], connections: ['FIN', 'LGL', 'GP'], isExample: false },
            // Comercial
            { id: 'COM-01', label: 'COM-01', title: 'COM-01 (Operativo)', category: 'Operational', declaration: "Asegurar cumplimiento 100% plan facturación mensual...", subObjectives: ["Validar mensualmente hitos...", "Emitir 100% facturas...", "Realizar seguimiento semanal..."], connections: ['FIN', 'GP', 'CNT'], isExample: false },
            { id: 'COM-02', label: 'COM-02', title: 'COM-02 (Estratégico)', category: 'Strategic', declaration: "Captar y mantener activamente mínimo 10 clientes estratégicos...", subObjectives: ["Definir criterios clientes estratégicos...", "Asignar Key Account Manager...", "Desarrollar planes cuenta individuales..."], connections: ['NN', 'GP', 'DIR'], isExample: false },
            { id: 'COM-03', label: 'COM-03', title: 'COM-03 (Táctico)', category: 'Tactical', declaration: "Lograr calificación satisfacción cliente comercial superior 90%...", subObjectives: ["Implementar encuesta semestral...", "Analizar resultados e identificar...", "Establecer planes acción..."], connections: ['GP', 'FIN', 'LGL'], isExample: false },
            { id: 'COM-04', label: 'COM-04', title: 'COM-04 (Estratégico)', category: 'Strategic', declaration: "Mejorar tasa recompra o fidelización clientes existentes 15%...", subObjectives: ["Identificar clientes potencial recompra...", "Desarrollar ofertas proactivas...", "Implementar programa lealtad..."], connections: ['NN', 'GP', 'MKT'], isExample: false },
            { id: 'COM-06', label: 'COM-06', title: 'COM-06 (Estratégico)', category: 'Strategic', declaration: "Implementar programa formal Key Account Management (KAM)...", subObjectives: ["Definir metodología y herramientas...", "Capacitar KAMs designados...", "Realizar primera ronda revisiones..."], connections: ['NN', 'GP', 'DIR'], isExample: false },
            { id: 'COM-07', label: 'COM-07', title: 'COM-07 (Estratégico)', category: 'Strategic', declaration: "Desarrollar mapas experiencia cliente (Customer Journey Maps)...", subObjectives: ["Identificar principales viajes cliente...", "Mapear interacciones, emociones...", "Validar mapas con feedback..."], connections: ['GP', 'NN', 'MKT', 'OPER'], isExample: false },
            { id: 'COM-08', label: 'COM-08', title: 'COM-08 (Táctico)', category: 'Tactical', declaration: "Crear sistema circuito cerrado retroalimentación cliente...", subObjectives: ["Centralizar canales recepción...", "Establecer proceso asignar...", "Analizar trimestralmente feedback..."], connections: ['GP', 'CALIDAD', 'MKT'], isExample: false },
            { id: 'COM-11', label: 'COM-11', title: 'COM-11 (Operativo)', category: 'Operational', declaration: "Asegurar 100% equipo comercial tenga conocimiento profundo servicios...", subObjectives: ["Desarrollar material capacitación...", "Realizar sesiones capacitación...", "Evaluar conocimiento mediante..."], connections: ['NN', 'GP', 'ING', 'GH'], isExample: false },
            { id: 'COM-12', label: 'COM-12', title: 'COM-12 (Táctico)', category: 'Tactical', declaration: "Implementar proceso proactivo gestión renovaciones contractuales...", subObjectives: ["Identificar contratos vencimiento...", "Establecer alertas y asignar...", "Preparar propuesta renovación..."], connections: ['LGL', 'FIN', 'GP'], isExample: false },
            { id: 'COM-13', label: 'COM-13', title: 'COM-13 (Táctico)', category: 'Tactical', declaration: "Reducir tiempo promedio resolver disputas contractuales o comerciales...", subObjectives: ["Establecer proceso interno claro...", "Empoderar KAMs/Comerciales...", "Fomentar comunicación abierta..."], connections: ['LGL', 'FIN', 'GP'], isExample: false },
            { id: 'COM-14', label: 'COM-14', title: 'COM-14 (Táctico)', category: 'Tactical', declaration: "Desarrollar y presentar informes desempeño trimestrales personalizados...", subObjectives: ["Definir KPIs y formato informe...", "Recopilar datos y preparar...", "Presentar y discutir informes..."], connections: ['GP', 'FIN'], isExample: false },
            // Estrategia
            { id: 'EST-13', label: 'EST-13', title: 'EST-13 (Estratégico)', category: 'Strategic', declaration: "Evaluar anualmente alineación portafolio actual servicios...", subObjectives: ["Analizar rentabilidad y potencial...", "Comparar portafolio con tendencias...", "Presentar recomendaciones sobre..."], connections: ['FIN', 'NN', 'COM', 'GP'], isExample: false },
        ];
        const processAreas = [
            { id: 'FIN', label: 'Financiero' }, { id: 'LOG', label: 'Logístico/\nCompras' }, { id: 'ADM', label: 'Administrativo' },
            { id: 'GH', label: 'Gestión Humana' }, { id: 'LGL', label: 'Legal' }, { id: 'GP', label: 'Gerencia Proy.' },
            { id: 'NN', label: 'Nuevos Negocios' }, { id: 'CNT', label: 'Contabilidad' }, { id: 'COM', label: 'Comercial' },
            { id: 'EST', label: 'Estrategia' }, { id: 'TI', label: 'TI' }, { id: 'MANT', label: 'Mantenimiento' },
            { id: 'SST', label: 'SST/Méd/Amb' }, { id: 'AUD_INT', label: 'Auditoría Int.' }, { id: 'AUD_EXT', label: 'Auditoría Ext.' },
            { id: 'CALIDAD', label: 'Calidad' }, { id: 'OPER', label: 'Operaciones' }, { id: 'DIR', label: 'Dirección' },
            { id: 'MKT', label: 'Marketing/\nComms' }, { id: 'ING', label: 'Ingeniería/\nTécnica' }, { id: 'REL_COM', label: 'Rel. Comunitarias' },
            { id: 'REL_INST', label: 'Rel. Institucionales' }, { id: 'SEGURIDAD', label: 'Seguridad' }, { id: 'CLIENTE', label: 'Cliente' },
            { id: 'PROV', label: 'Proveedores' }, { id: 'TODAS', label: 'Todas las Áreas\n(Genérico)' }, { id: 'AREAS_SOLIC', label: 'Áreas Solicitantes' },
            { id: 'AREAS_AFECT', label: 'Áreas Afectadas' }, { id: 'AREAS_AUDIT', label: 'Áreas Auditadas' }, { id: 'AREAS_IMPLEM', label: 'Áreas Implement.' },
            { id: 'AREAS_PROV_INFO', label: 'Áreas Prov. Info' }, { id: 'AREAS_ORIG_TRANS', label: 'Áreas Orig. Trans.' }, { id: 'AREAS_CONT_CONTR', label: 'Áreas Usuarias Cont.' },
            { id: 'AREAS_PERS_OP', label: 'Áreas Pers. Oper.' }, { id: 'AREAS_GEREN', label: 'Gerencias Área' }, { id: 'AREAS_GEREN_RIESGO', label: 'Gerencias Riesgo' },
            { id: 'AREAS_INV', label: 'Áreas Involucradas' }, { id: 'AREAS_UNIDAD', label: 'Gerencias Unidad' }, { id: 'AREAS_TALLER', label: 'Áreas Taller' },
            { id: 'AREAS_PROP', label: 'Áreas Proponentes' },
        ];
        const processAreaMap = new Map(processAreas.map(p => [p.id, p]));
        const condugasColors = { strategic: '#f8b133', tactical: '#1d70b7', operational: '#ffda05', process: '#292d63', defaultObjective: '#9ca3af' };

        // --- Filter Data for Current Process (GP) ---
        const currentProcessObjectives = objectivesData.filter(obj => obj.id.startsWith(currentProcessId + '-'));
        const connectedProcessIds = new Set([currentProcessId]);
        currentProcessObjectives.forEach(obj => { (obj.connections || []).forEach(connId => connectedProcessIds.add(connId)); });
        objectivesData.forEach(obj => {
            if (!obj.id.startsWith(currentProcessId + '-')) {
                if ((obj.connections || []).includes(currentProcessId)) {
                    if (!currentProcessObjectives.some(existingObj => existingObj.id === obj.id)) {
                        currentProcessObjectives.push(obj);
                    }
                    (obj.connections || []).forEach(connId => connectedProcessIds.add(connId));
                }
            }
        });
        const uniqueCurrentProcessObjectives = Array.from(new Set(currentProcessObjectives.map(obj => obj.id)))
            .map(id => currentProcessObjectives.find(obj => obj.id === id));

        // --- Create Nodes & Edges (Logic identical to proceso_estrategia.html) ---
        const nodes = new vis.DataSet();
        const objectiveDetailsMap = new Map();
        const currentProcessData = processAreaMap.get(currentProcessId);
        if (currentProcessData) {
            nodes.add({ id: currentProcessData.id, label: currentProcessData.label.replace('\n', '\n'), shape: 'box', color: { background: condugasColors.process, border: '#1e293b' }, font: { color: 'white', size: 14, face: 'Inter', bold: { size: 15 } }, margin: 15, title: `Proceso Principal: ${currentProcessData.label.replace('\n', ' ')}`, group: 'process', fixed: false, mass: 3 });
        }
        uniqueCurrentProcessObjectives.forEach(obj => {
            let color, borderColor;
            switch (obj.category) {
                case 'Strategic': color = condugasColors.strategic; borderColor = '#b45309'; break;
                case 'Tactical': color = condugasColors.tactical; borderColor = '#1e3a8a'; break;
                case 'Operational': color = condugasColors.operational; borderColor = '#a16207'; break;
                default: color = condugasColors.defaultObjective; borderColor = '#4b5563';
            }
            const declarationText = obj.declaration || `Declaración del objetivo ${obj.id} (placeholder).`;
            const subObjectivesList = obj.subObjectives || [`Sub-objetivo 1 (placeholder).`, `Sub-objetivo 2 (placeholder).`, `Sub-objetivo 3 (placeholder).`];
            nodes.add({ id: obj.id, shape: 'dot', size: 12, color: { background: color, border: borderColor, highlight: { background: color, border: '#000000' }, hover: { background: color, border: '#000000' } }, title: obj.title, group: obj.category, mass: 1 });
            objectiveDetailsMap.set(obj.id, { ...obj, declaration: declarationText, subObjectives: subObjectivesList, isExample: obj.isExample || false });
        });
        connectedProcessIds.forEach(procId => {
            if (procId !== currentProcessId && processAreaMap.has(procId)) {
                 const procData = processAreaMap.get(procId);
                 if (!nodes.get(procData.id)) {
                     nodes.add({ id: procData.id, label: procData.label.replace('\n', '\n'), shape: 'box', color: { background: condugasColors.process, border: '#1e293b', opacity: 0.8 }, font: { color: '#e5e7eb', size: 10, face: 'Inter', bold: { size: 11 } }, margin: { top: 8, right: 12, bottom: 8, left: 12 }, title: `Área/Proceso Conectado: ${procData.label.replace('\n', ' ')}`, group: 'process', fixed: false, mass: 1.5 });
                 }
            }
        });
        const edges = new vis.DataSet();
        uniqueCurrentProcessObjectives.forEach(obj => {
            (obj.connections || []).forEach(connId => {
                if (nodes.get(obj.id) && nodes.get(connId)) {
                    edges.add({ from: obj.id, to: connId, arrows: { to: { enabled: true, scaleFactor: 0.6, type: 'arrow' } }, length: 150, color: { color: '#d1d5db', highlight: condugasColors.process, hover: condugasColors.process, inherit: false }, width: 0.7, hoverWidth: 1.5 });
                }
            });
        });

        // --- Network Configuration & Initialization (Same as proceso_estrategia.html) ---
        const container = document.getElementById('objectiveNetwork');
        const data = { nodes: nodes, edges: edges };
        const options = {
            nodes: { borderWidth: 1.5, borderWidthSelected: 3, font: { size: 11, face: 'Inter, sans-serif', color: '#374151' }, shapeProperties: { borderRadius: 4 } },
            edges: { smooth: { enabled: true, type: "dynamic", roundness: 0.4 }, width: 0.7, color: { color: '#d1d5db', opacity: 0.7, highlight: '#1d70b7', hover: '#1d70b7' } },
            physics: { enabled: true, solver: 'forceAtlas2Based', forceAtlas2Based: { gravitationalConstant: -70, centralGravity: 0.02, springLength: 180, springConstant: 0.08, damping: 0.7, avoidOverlap: 0.9 }, stabilization: { enabled: true, iterations: 1500, updateInterval: 25, onlyDynamicEdges: false, fit: true } },
            interaction: { hover: true, tooltipDelay: 150, navigationButtons: true, keyboard: true, dragNodes: true, dragView: true, zoomView: true, hoverConnectedEdges: true },
            layout: { improvedLayout: true }
        };
        const network = new vis.Network(container, data, options);

        // --- Detail Panel & Event Listeners (Same as proceso_estrategia.html) ---
        const detailPanel = document.getElementById('detailPanel');
        const detailTitle = document.getElementById('detailTitle');
        const detailDeclaration = document.getElementById('detailDeclaration');
        const detailSubObjectives = document.getElementById('detailSubObjectives');
        const detailConnections = document.getElementById('detailConnections');
        const detailDataStatus = document.getElementById('detailDataStatus');
        const closeDetailPanelButton = document.getElementById('closeDetailPanel');

        network.on('click', function(params) {
            detailPanel.classList.remove('show'); network.unselectAll();
            if (params.nodes.length > 0) {
                const nodeId = params.nodes[0];
                const nodeData = objectiveDetailsMap.get(nodeId);
                const visNodeData = nodes.get(nodeId);
                if (nodeData && visNodeData.group !== 'process') {
                    network.selectNodes([nodeId]);
                    detailTitle.textContent = `${nodeData.id} (${nodeData.category})`;
                    detailDeclaration.textContent = nodeData.declaration;
                    if (nodeData.subObjectives && nodeData.subObjectives.length > 0) {
                        let subObjectivesHtml = '<ul>';
                        nodeData.subObjectives.forEach(sub => { subObjectivesHtml += `<li class="text-gray-600">${sub}</li>`; });
                        subObjectivesHtml += '</ul>';
                        detailSubObjectives.innerHTML = subObjectivesHtml;
                    } else {
                        detailSubObjectives.innerHTML = '<p class="text-gray-500 italic">Sub-objetivos no disponibles.</p>';
                    }
                    const connectionLabels = (nodeData.connections || []).filter(connId => nodes.get(connId)).map(connId => nodes.get(connId)?.label?.replace(/\n/g, ' ') || connId).join(', ');
                    detailConnections.textContent = connectionLabels || 'Ninguna';
                    if (nodeData.isExample) { detailDataStatus.textContent = 'Datos completos mostrados (nodo de ejemplo).'; detailDataStatus.style.color = '#15803d'; }
                    else { detailDataStatus.textContent = 'Nota: Datos completos solo disponibles para nodos de ejemplo.'; detailDataStatus.style.color = '#6b7280'; }
                    setTimeout(() => { detailPanel.classList.add('show'); }, 50);
                }
            }
        });
        closeDetailPanelButton.addEventListener('click', function() { detailPanel.classList.remove('show'); network.unselectAll(); });
        const tooltip = document.getElementById('tooltip');
        network.on("hoverNode", function (params) { const nodeId = params.node; const nodeData = nodes.get(nodeId); if (nodeData && nodeData.title) { tooltip.innerHTML = nodeData.title; tooltip.style.visibility = 'visible'; const pointer = params.pointer.DOM; tooltip.style.left = pointer.x + 10 + 'px'; tooltip.style.top = pointer.y + 10 + 'px'; } });
        network.on("blurNode", function (params) { tooltip.style.visibility = 'hidden'; });
        network.once('stabilizationIterationsDone', function() { network.setOptions({ physics: false }); });
        window.addEventListener('resize', function() { network.fit(); });
    </script>
</body>
</html>
